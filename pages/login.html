<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <title>R&M Cafe</title>
    <link rel="stylesheet" href="../assets/css/login.css">
</head>

<body>
    <div>
        <h1 class="now">R&M Cafe</h1>
        <span class="rm">
            <a class="a-1" href="../index.html" >Home</a>
            <a class="a-1" href="./rmmenu.html" >Menu</a>
            <a class="a-1" href="./rmreview.html" >Review</a>
            <a class="a-1" href="./rmcontact.html" >Contact</a>
            <a class="a-1" href="./cart.html" >Cart</a>
        </span>
    </div>

    <br>
    <hr>

    <div class="div-1">
        <form class="form" onsubmit="submitHandler()">
            <label>Email:</label> <input type="text" class="input-1" id="email" required> <br>
            <label>Password:</label> <input type="password" class="input-2" id="password" required> <br>
            <input type="checkbox" id="showPassword" onchange="showPwd()"><label class="pw">Show password</label><br>
            <div id="error">

            </div>
            <button type="submit">Login</button>
        </form>
    </div>

    <script>
        function submitHandler() {
            event.preventDefault();
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;

            const isExist = isUserExist(email, password);
            if (isExist == false) {
                document.getElementById("error").innerText = "Invalid login details !!";
            } else {
                localStorage.setItem("loggedInUser", email);
                window.location.href = "./rmmenu.html";
            }
        }

        function isUserExist(newEmail, newPassword) {
            let isthere = false;

            const userList = getUserDetails();
            for (i = 0; i < userList.length; i++) {
                let user = userList[i];
                let oldEmail = user.email;
                let oldPassword = user.password;
                if (oldEmail === newEmail && oldPassword === newPassword) {
                    isthere = true;
                    break;
                }
            }
            return isthere;

        }

        function getUserDetails() {
            let parsedDetails = JSON.parse(localStorage.getItem("details"));
            console.log(parsedDetails);
            return parsedDetails;


        }

        function showPwd() {
            const pass = document.getElementById("showPassword");
            if (pass.checked == true) {
                document.getElementById("password").type = "text";
            } else {
                document.getElementById("password").type = "password";
            }
        }
    </script>

</body>

</html>